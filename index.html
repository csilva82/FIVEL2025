<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Feira FIVEL 2025 - 3D Interativa</title>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; overflow: hidden; background: #000; cursor: default; }
canvas { display: block; cursor: crosshair; }
body.modal-open canvas { cursor: default; }
#ui-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; }
#controls-info { position: absolute; top: 20px; left: 20px; background: rgba(0,0,0,0.8); color: white; padding: 20px; border-radius: 10px; font-size: 14px; line-height: 1.6; max-width: 300px; backdrop-filter: blur(10px); }
#controls-info h3 { margin-bottom: 10px; color: #4CAF50; }
#controls-info kbd { background: #333; padding: 3px 8px; border-radius: 4px; font-family: monospace; font-size: 12px; border: 1px solid #555; }
#crosshair { position: absolute; top: 50%; left: 50%; transform: translate(-50%,-50%); width: 20px; height: 20px; pointer-events: none; }
#crosshair::before,#crosshair::after { content:''; position:absolute; background:rgba(255,255,255,0.8);}
#crosshair::before { top:50%; left:0; width:100%; height:2px; transform:translateY(-50%);}
#crosshair::after { left:50%; top:0; width:2px; height:100%; transform:translateX(-50%);}
#hover-info { position:absolute; bottom:100px; left:50%; transform:translateX(-50%); background:rgba(76,175,80,0.95); color:white; padding:15px 30px; border-radius:25px; font-size:18px; font-weight:bold; opacity:0; transition:opacity 0.3s; pointer-events:none; box-shadow:0 4px 20px rgba(0,0,0,0.4);}
#hover-info.visible { opacity:1;}
#minimap { position:absolute; top:20px; right:20px; width:300px; height:200px; background:rgba(0,0,0,0.9); border:3px solid #4CAF50; border-radius:10px; pointer-events:all; cursor:pointer; backdrop-filter: blur(10px);}
#minimap-title { position:absolute; top:8px; left:50%; transform:translateX(-50%); color:#4CAF50; font-size:13px; font-weight:bold; pointer-events:none; z-index:10;}
#loading { position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); color:white; font-size:24px; background:rgba(0,0,0,0.9); padding:30px 50px; border-radius:15px; text-align:center;}
.hidden { display:none !important; }
#instructions { position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); background:rgba(0,0,0,0.95); color:white; padding:40px; border-radius:15px; text-align:center; max-width:500px; pointer-events:all; }
#instructions h2 { color:#4CAF50; margin-bottom:20px;}
#instructions button { background:#4CAF50; color:white; border:none; padding:15px 40px; font-size:18px; border-radius:25px; cursor:pointer; margin-top:20px; transition:background 0.3s; }
#instructions button:hover { background:#45a049; }
#custom-modal { position: fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.85); display:flex; align-items:center; justify-content:center; pointer-events:all; z-index:1000; }
#modal-content { background:linear-gradient(135deg,#667eea 0%,#764ba2 100%); padding:40px; border-radius:20px; text-align:center; max-width:500px; box-shadow:0 20px 60px rgba(0,0,0,0.5); animation:modalSlideIn 0.3s ease-out; }
@keyframes modalSlideIn { from{transform:translateY(-50px);opacity:0;} to{transform:translateY(0);opacity:1;} }
#modal-content h3 { color:white; font-size:24px; margin-bottom:15px; }
#modal-content p { color:rgba(255,255,255,0.9); font-size:16px; margin-bottom:10px; }
#modal-content .url-display { background: rgba(0,0,0,0.3); padding:10px; border-radius:8px; color:#fff; font-family:monospace; font-size:14px; margin:20px 0; word-break:break-all; }
#modal-buttons { display:flex; gap:15px; justify-content:center; margin-top:25px; }
#modal-buttons button { padding:12px 30px; font-size:16px; border:none; border-radius:25px; cursor:pointer; font-weight:bold; transition:all 0.3s; text-transform:uppercase; letter-spacing:1px;}
#modal-visit { background:#4CAF50; color:white; }
#modal-visit:hover { background:#45a049; transform:translateY(-2px); box-shadow:0 5px 15px rgba(76,175,80,0.4);}
#modal-cancel { background:rgba(255,255,255,0.2); color:white;}
#modal-cancel:hover { background:rgba(255,255,255,0.3); transform:translateY(-2px); }

/* BOT√ïES M√ìVEL */
#mobile-controls { position:absolute; bottom:20px; left:20px; display:flex; flex-wrap:wrap; width:120px; height:120px; gap:10px; pointer-events:all; z-index:100;}
#mobile-controls button { flex:1 1 40px; background:rgba(76,175,80,0.5); border:none; color:white; font-size:20px; border-radius:10px; opacity:0.8; transition:opacity 0.2s;}
#mobile-controls button:active { opacity:1;}
</style>
</head>
<body>
<div id="loading">Carregando Feira FIVEL 2025...</div>

<div id="instructions">
  <h2>üé™ Bem-vindo √† FIVEL 2025!</h2>
  <p style="margin:20px 0;">Navegue pela feira virtual e clique nos estandes para visitar os sites dos expositores.</p>
  <p style="font-size:14px; color:#ccc;">Use WASD ou setas para se mover, mouse para olhar ao redor.</p>
  <button id="start-btn">Entrar na Feira</button>
</div>

<div id="ui-overlay">
  <div id="controls-info">
    <h3>‚å®Ô∏è Controles</h3>
    <div><kbd>W</kbd><kbd>A</kbd><kbd>S</kbd><kbd>D</kbd> - Mover</div>
    <div><kbd>‚Üë</kbd><kbd>‚Üê</kbd><kbd>‚Üì</kbd><kbd>‚Üí</kbd> - Mover</div>
    <div><kbd>Mouse</kbd> - Olhar</div>
    <div><kbd>Click</kbd> - Interagir</div>
    <div style="margin-top:10px; padding-top:10px; border-top:1px solid #333;"><kbd>ESC</kbd> - Sair da feira</div>
  </div>
  <div id="crosshair"></div>
  <div id="hover-info">üñ±Ô∏è Clique para visitar</div>
  <div id="minimap"><div id="minimap-title">üó∫Ô∏è MAPA DA FEIRA</div></div>
</div>

<div id="mobile-controls">
  <button id="up">‚Üë</button>
  <button id="left">‚Üê</button>
  <button id="down">‚Üì</button>
  <button id="right">‚Üí</button>
</div>

<div id="custom-modal" class="hidden">
  <div id="modal-content">
    <h3 id="modal-label">Estande</h3>
    <p id="modal-text">Deseja visitar o site deste estande?</p>
    <div class="url-display" id="modal-url"></div>
    <div id="modal-buttons">
      <button id="modal-visit">‚úì Visitar</button>
      <button id="modal-cancel">‚úï Cancelar</button>
    </div>
  </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script>
// ==================== THREE.js Setup ====================
const scene = new THREE.Scene();
scene.background = new THREE.Color(0x87ceeb);
scene.fog = new THREE.Fog(0x87ceeb,0,120);
const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight,0.1,1000);
camera.position.set(-32,1.7,-25);
camera.quaternion.setFromEuler(new THREE.Euler(0, Math.PI,0,'YXZ'));
const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(window.innerWidth,window.innerHeight);
document.body.appendChild(renderer.domElement);

// ==================== Luzes ====================
const ambientLight = new THREE.AmbientLight(0xffffff,0.6);
scene.add(ambientLight);
const directionalLight = new THREE.DirectionalLight(0xffffff,0.8);
directionalLight.position.set(10,50,30);
scene.add(directionalLight);

// ==================== Ch√£o ====================
const floorGeometry = new THREE.PlaneGeometry(200,150);
const floorMaterial = new THREE.MeshStandardMaterial({color:0x333333});
const floor = new THREE.Mesh(floorGeometry,floorMaterial);
floor.rotation.x = -Math.PI/2;
scene.add(floor);

// ==================== Estandes ====================
const estandes = [
  {name:"Estande 1", pos:[-10,0,-10], url:"https://example.com/1"},
  {name:"Estande 2", pos:[0,0,-10], url:"https://example.com/2"},
  {name:"Estande 3", pos:[10,0,-10], url:"https://example.com/3"}
];
const boxGeo = new THREE.BoxGeometry(3,3,3);
const boxMat = new THREE.MeshStandardMaterial({color:0x4CAF50});
estandes.forEach(e=>{
  const box = new THREE.Mesh(boxGeo, boxMat.clone());
  box.position.set(...e.pos);
  box.userData={name:e.name,url:e.url};
  scene.add(box);
});

// ==================== Raycaster ====================
const raycaster = new THREE.Raycaster();
const mouse = new THREE.Vector2();
let INTERSECTED;

// ==================== Modal ====================
const modal = document.getElementById('custom-modal');
const modalLabel = document.getElementById('modal-label');
const modalUrl = document.getElementById('modal-url');
const btnVisit = document.getElementById('modal-visit');
const btnCancel = document.getElementById('modal-cancel');
let currentUrl = '';

btnVisit.onclick = ()=>{ window.open(currentUrl,'_blank'); hideModal();}
btnCancel.onclick = ()=>{ hideModal(); }
function showModal(name,url){
  modalLabel.textContent = name;
  modalUrl.textContent = url;
  currentUrl=url;
  modal.classList.remove('hidden');
}
function hideModal(){ modal.classList.add('hidden'); }

// ==================== Controles ====================
const keys = {w:false,a:false,s:false,d:false,arrowup:false,arrowdown:false,arrowleft:false,arrowright:false};
document.addEventListener('keydown', e=>{
  if(e.key.toLowerCase()==='w') keys.w=true;
  if(e.key.toLowerCase()==='a') keys.a=true;
  if(e.key.toLowerCase()==='s') keys.s=true;
  if(e.key.toLowerCase()==='d') keys.d=true;
  if(e.key==='ArrowUp') keys.arrowup=true;
  if(e.key==='ArrowDown') keys.arrowdown=true;
  if(e.key==='ArrowLeft') keys.arrowleft=true;
  if(e.key==='ArrowRight') keys.arrowright=true;
});
document.addEventListener('keyup', e=>{
  if(e.key.toLowerCase()==='w') keys.w=false;
  if(e.key.toLowerCase()==='a') keys.a=false;
  if(e.key.toLowerCase()==='s') keys.s=false;
  if(e.key.toLowerCase()==='d') keys.d=false;
  if(e.key==='ArrowUp') keys.arrowup=false;
  if(e.key==='ArrowDown') keys.arrowdown=false;
  if(e.key==='ArrowLeft') keys.arrowleft=false;
  if(e.key==='ArrowRight') keys.arrowright=false;
});

// ==================== Mobile Buttons ====================
['up','down','left','right'].forEach(dir=>{
  const btn = document.getElementById(dir);
  btn.addEventListener('touchstart', ()=>{ 
    if(dir==='up') keys.w = true;      // mover para frente
    if(dir==='down') keys.s = true;    // mover para tr√°s
    if(dir==='left') keys.a = true;    // mover para esquerda
    if(dir==='right') keys.d = true;   // mover para direita
  });
  btn.addEventListener('touchend', ()=>{ 
    if(dir==='up') keys.w = false;     
    if(dir==='down') keys.s = false;   
    if(dir==='left') keys.a = false;   
    if(dir==='right') keys.d = false;  
  });
  btn.addEventListener('touchcancel', ()=>{ 
    if(dir==='up') keys.w = false;     
    if(dir==='down') keys.s = false;   
    if(dir==='left') keys.a = false;   
    if(dir==='right') keys.d = false;  
  });
});

// ==================== Movimenta√ß√£o ====================
const moveSpeed = 0.3;
function updateMovement(){
  const direction = new THREE.Vector3();
  const right = new THREE.Vector3();
  camera.getWorldDirection(direction);
  direction.y=0; direction.normalize();
  right.crossVectors(camera.up,direction).normalize();
  const velocity = new THREE.Vector3();
  if(keys.w || keys.arrowup) velocity.add(direction);
  if(keys.s || keys.arrowdown) velocity.sub(direction);
  if(keys.a || keys.arrowleft) velocity.add(right);
  if(keys.d || keys.arrowright) velocity.sub(right);
  if(velocity.length()>0){
    velocity.normalize().multiplyScalar(moveSpeed);
    camera.position.add(velocity);
    camera.position.x=Math.max(-40,Math.min(40,camera.position.x));
    camera.position.z=Math.max(-30,Math.min(20,camera.position.z));
  }
}

// ==================== Raycaster Hover ====================
const hoverInfo = document.getElementById('hover-info');
function updateRaycaster(){
  raycaster.setFromCamera(new THREE.Vector2(0,0), camera);
  const intersects = raycaster.intersectObjects(scene.children);
  let hover = false;
  if(intersects.length>0){
    const obj = intersects[0].object;
    if(obj.userData.url){
      INTERSECTED=obj;
      hoverInfo.textContent='Clique para visitar: '+obj.userData.name;
      hoverInfo.classList.add('visible');
      hover=true;
    }
  }
  if(!hover){ INTERSECTED=null; hoverInfo.classList.remove('visible'); }
}

// ==================== Click Intera√ß√£o ====================
window.addEventListener('click', ()=>{
  if(INTERSECTED){
    showModal(INTERSECTED.userData.name, INTERSECTED.userData.url);
  }
});

// ==================== Start Button ====================
document.getElementById('start-btn').onclick = ()=>{
  document.getElementById('instructions').classList.add('hidden');
  document.getElementById('loading').classList.add('hidden');
}

// ==================== Resize ====================
window.addEventListener('resize', ()=>{
  camera.aspect=window.innerWidth/window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth, window.innerHeight);
});

// ==================== Animation Loop ====================
function animate(){
  requestAnimationFrame(animate);
  updateMovement();
  updateRaycaster();
  renderer.render(scene,camera);
}
animate();
</script>
</body>
</html>
